#!/usr/bin/env nu

use ../../lib/bf/

const $init_d = "/etc/bf/init.d"

# Initialise the container by executing all scripts contained in /etc/bf/init.d
def main [] {
    bf print debug "Initialising container."
    if ($init_d | path exists) { ls $init_d | get name | sort | each { |x| execute $x } }
    bf print debug "Init complete."
}

# Execute a file within the init.d directory
def execute [
    name: string    # Name of file (within init.d directory)
] {
    bf print $"($name): Running..."
    let path = $"($init_d)/($name)"
    chmod +x $path; $path
    bf print debug $"($name): Done."
}
