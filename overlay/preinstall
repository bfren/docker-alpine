#!/bin/sh

set -euo pipefail


#======================================================================================================================
# Install nushell and dependencies.
#======================================================================================================================

apk add --no-cache \
    busybox-binsh@edgemain \
    libcrypto3@edgemain \
    libssl3@edgemain \
    nushell@edgetest


#======================================================================================================================
# Rename nu executable and copy custom nu into place.
#======================================================================================================================

NU=/usr/bin/nu
mv ${NU} /usr/bin/nushell
mv /tmp/nu ${NU}
chmod 0444 ${NU}


#======================================================================================================================
# Make bf-install executable.
#======================================================================================================================

chmod +x /usr/bin/bf/bf-install


#======================================================================================================================
# Delete self.
#======================================================================================================================

rm /preinstall
