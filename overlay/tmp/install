#!/bin/sh

set -euo pipefail
export BF_E=`basename ${0}`


#======================================================================================================================
# Get esh version.
#======================================================================================================================

cd /tmp

ESH_VERSION=$(cat ESH_BUILD)
bf-echo "esh version ${ESH_VERSION}."


#======================================================================================================================
# Upgrade to latest possible version of busybox.
#======================================================================================================================

bf-echo "Upgrading binaries..."
apk upgrade --no-cache
bf-done


#======================================================================================================================
# Install esh template engine.
#======================================================================================================================

bf-echo "Installing esh v${ESH_VERSION}..."
apk add --no-cache esh=${ESH_VERSION} && bf-done \
    || bf-error "esh not installed."


#======================================================================================================================
# Install other packages.
#======================================================================================================================

bf-echo "Installing additional packages..."
apk add --no-cache figlet && bf-done \
    || bf-error "Unable to install additional packages."


#======================================================================================================================
# Set timezone.
#======================================================================================================================

bf-tz "Europe/London"
